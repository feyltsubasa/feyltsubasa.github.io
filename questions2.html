<!DOCTYPE html>
<html>
  <head>
    <title>填空題答題</title>
  </head>
  <body>
    <h1>填空題答題</h1>
    <p id="question"></p>
    <input type="text" id="answer" placeholder="請輸入答案">
    <button id="submit">提交答案</button>
    <p id="result"></p>
    <p id="countdown">剩餘時間：180</p>

    <script>
      // 載入填空題數據
      fetch("questions2.json")
        .then(response => response.json())
        .then(data => {
          // 解析 JSON 文件，打亂問題順序
          var questionOrder = shuffleArray(data.questions);

          // 設定倒數時間為三分鐘，單位為毫秒
          var countdownTime = 3 * 60 

          // 取得 DOM 元素
          var questionElement = document.getElementById("question");
          var answerElement = document.getElementById("answer");
          var submitElement = document.getElementById("submit");
          var resultElement = document.getElementById("result");
          var countdownElement = document.getElementById("countdown");

          // 開始倒數計時器
          var countdownInterval = setInterval(function() {
            // 取得目前時間
            var now = new Date().getTime();

            // 計算剩餘時間
            countdownTime = countdownTime - 1;

    

            // 更新倒數計時器顯示的內容
            countdownElement.innerHTML = "剩餘時間：" + countdownTime;

            // 如果時間到了，停止倒數計時器
            if (countdownTime <= 0) {
              clearInterval(countdownInterval);
              submitElement.disabled = true;
              resultElement.innerHTML = "時間到！";
            }
          }, 1000);

          // 顯示第一個問題
          showQuestion(0);

          // 綁定提交按鈕的點擊事件
          submitElement.addEventListener("click", function() {
            // 取得目前問題的答案
            var currentAnswer = questionOrder[0].answer;

            // 取得用戶輸入的答案
            var userAnswer = answerElement.value.trim();

            // 比對答案，顯示提示
            if (userAnswer === currentAnswer) {
              resultElement.innerHTML = "答對了！";
            } else {
              resultElement.innerHTML = "答錯了，正確答案是：" + currentAnswer;
            }

            // 刪除已經回答的問題，顯示下一個問題
            questionOrder.shift();
            if (questionOrder.length > 0) {
              showQuestion(0);
            } else {
              clearInterval(countdownInterval);
              submitElement.disabled = true;
              resultElement.innerHTML = "恭喜您完成了所有問題！";
            }

            // 清空輸入框
            answerElement.value = "";
          });

          // 顯示指定序號的問題
          function showQuestion(index) {
            var question = questionOrder[index];
            questionElement.innerHTML = question.text;
          }

          // 打亂陣列的順序
          function shuffleArray(array) {
            var currentIndex = array.length, temporaryValue, randomIndex;
            while (0 !== currentIndex) {
              randomIndex = Math.floor(Math.random() * currentIndex);
              currentIndex -= 1;
              temporaryValue = array[currentIndex];
              array[currentIndex] = array[randomIndex];
              array[randomIndex] = temporaryValue;
            }
            return array;
          }
        });
    </script>
  </body>
</html>